/* This file has been generated by ecm_create_qm_loader(). Do not modify!
 *
 * Building this file in a library ensures translations are automatically loaded
 * when an application makes use of the library.
 */
#include <QCoreApplication>
#include <QLocale>
#include <QStandardPaths>
#include <QTranslator>

#include <QDebug>

static bool loadTranslation(const QString &localeDirName)
{
    QString subPath = QStringLiteral("locale/") + localeDirName + QStringLiteral("/LC_MESSAGES/@catalog_name@.qm");
    QString fullPath = QStandardPaths::locate(QStandardPaths::GenericDataLocation, subPath);
    if (fullPath.isEmpty()) {
        return false;
    }
    QTranslator *translator = new QTranslator(QCoreApplication::instance());
    if (!translator->load(fullPath)) {
        delete translator;
        return false;
    }
    QCoreApplication::instance()->installTranslator(translator);
    return true;
}

static void load()
{
    // The way Qt translation system handles plural forms makes it necessary to
    // have a translation file which contains only plural forms for `en`. That's
    // why we load the `en` translation unconditionally, then load the
    // translation for the current locale to overload it.
    loadTranslation(QStringLiteral("en"));

    QLocale locale = QLocale::system();
    if (locale.name() != QStringLiteral("en")) {
        if (!loadTranslation(locale.name())) {
            loadTranslation(locale.bcp47Name());
        }
    }
}

Q_COREAPP_STARTUP_FUNCTION(load)
